from codon_harmony.util import seq_opt_ga, codon_use, logging, log_levels
from codon_harmony.data import GC_content, RibosomeBindingSites, RestrictionEnzymes
from Bio import Seq
from Bio.Alphabet import IUPAC
from Bio.SeqUtils import GC


ancestor_sequence = Seq.Seq("ATGACTGCACTGGCTAGCTGTCATACTTGTAGCACTACTCCTACTCGTCGTGGTCTGTGCGGCCGTCCTACTTCTCTGGAATCCGCCGCTTCTCGTTGCGCTACCCACTATTCCGCATCTACCAGCGAGTGCGTGGCTAAATCTACCGCAGCTTCTCGTCGTCAACCGACCTGGACCCCACGTCGTGGTGTAGCTACCAAAGCCCTGTTCGACCCGCCGCCATTCAAACCTGAAAAACTGGCTGTACTGCTGGCTGCAGGTACCAGCTCTCTGGAACCGGCTCCTCCACGCTCTCGTAAGTATACCCTGACCCACAACGACATCACTGGCAACCTGCGTCTGACCATCGGCGCAGATTACAATCAACAACAAATCTCTGGCTTCTATACTCGCCTGCTGCGTGACGAAGTTATCGCCGAGTGGGTTGCAGTTGGCGCTTCTGGTTATGCGCTGCACGTTTACTGCCACGTAAGCGGTGAAGAACGTTGGCTGGCTCCGCCTCTGCTGCGTAACTACATCTTCCGTCGCGAGATGCCACTGGTTCTGGATACTATCGTTTATGCTGATCGTCAACTGCTGCAGCGTCAGCCTGAACTGGCGCGTGCTCAAGTCTATATTCATTTCCAGAGCTCTGTCCGTGAACTGGATACCGTGGAATATTGGGGCCTGCTGGGCGAACGTTCTACCTGGCCAAAAGGCCCAACTTCTATTCTGCTGCGCACCATCTACGCTATCATCGGTTGGCCTCCATACCTGGAAGCACTGCCGGCAGACCTGTCCATTGATCTGCCGGATGAAGTCCGTGATCTGGAGGAGGCAGTACGCTGGCAGCAGCAGCAGCGTCAACAAGGTCCTCGTCAAGAAGGTCTGCGCCAAGAAGGCCGCCAAGAAGCACGCCAAGAAGGTCGCCAGGAAGGTCGTCAAGAAGCTCGTCAGGAGGGTCGTCAAGAGGGTCGTCAGGAAGCGTGGCAAGAAGGTTGGCAGGATGGTTGGCAGGAGGGCCGTCAGGAGGTTGAACAGCTGCTGCGTCAGGAGCGCCGTAAAGCTGAACGCGGTCGTGAAGCTCGTGAGCGTGATCGTGAAGCTGAACGTGCTCGTGAACGCGAACCGTCTGCGGCTGTTGCGGGTACTCAGGCACTGGCACGTGCAGAAGCTGCTGTCCCTGTAGTTGAACCGGAAGAAGATCAGCAGCAGCCGCAACAGGGTGTTCCTGGTGCTGCACCGGACGCTCGTCAGGAATGGCAGCGTCAAGCTGCATCTCATGGTGCAGCTCCTGTTCAGGCTGCTGCTCCAGCACCTCCAACCGGTAGCTATCCACATAACGGCGCTCCGGCTTCTGAATCTACCCCATGTTCTGCTGGTACCAGCGCAGGTGAAGAAGCAGGTCGTTGGCCTGGTCGTAGCTCTACTAATGGTGCCGGCGTGCTGCGTCGTTCTGGTACTAGCTCCAGCTCTAGCAGCTCTGGTAACGGTCTGCTGCCAGCAGCTTCTCAGGCACCGGTTAACGGTTATAGCCTGAATGGCTCCGCGGCAGGTCGTTCTTCTCTGGAAGCTGGTGGCCTGAATGGTGTTGCACCTGGTGCTGGTGCAGAGGCACGTGCTTACGAACGTCGTGCTGCTCCTACTGTTGCTACTGCTGTTGCACCGTGTGCCGCTTCTGATGGTCAGCCGTGTAGCGGTGGTCCAGGTTGTTCCTGTGATGCTGCAGATCAGGCGCCGGAAGTTCCTGGTCGTGCAACCCCAGCTGCTGTTGCATCCGCAGGTAGCCCGGTTGGTCTGCCAGCTGCTCTGTCTGTCGAATTTAGCGCAGCCGCTGAACTGCTGGTGGGTACTGGTAGCCGTGCGGTTGCTCGTTCCTCCGCTAGC", IUPAC.ambiguous_dna)
host = "413997"
host_threshold = 0.1
local_host_profile = None
codon_use_table, host_profile, codon_relative_adativeness = codon_use.host_codon_usage(
        host, host_threshold, local_host_profile
    )
minimum_fitness = 0
generations = 100
gc = GC_content[0]
print(gc)
num_individuals = 50
restriction_sites = RestrictionEnzymes("NdeI XhoI HpaI PstI EcoRV NcoI BamHI".split())
rbs = RibosomeBindingSites
print(seq_opt_ga.the_sequence_optimizer(ancestor_sequence, codon_use_table, minimum_fitness, generations, gc, restriction_sites, rbs,num_individuals))
